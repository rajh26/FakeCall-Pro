<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙƒØ§Ù„Ù…Ø© 000000 Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/peerjs/1.4.7/peerjs.min.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        .card { background: #111; padding: 40px; border-radius: 30px; text-align: center; border: 1px solid #333; width: 280px; }
        .number { font-size: 50px; color: #22c55e; font-weight: bold; letter-spacing: 5px; margin: 20px 0; }
        .status { font-size: 14px; color: #888; margin-bottom: 20px; }
        .btn { background: #007aff; color: white; border: none; border-radius: 50px; padding: 15px 30px; width: 100%; font-weight: bold; font-size: 18px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,122,255,0.3); }
        .btn.active { background: #22c55e; }
    </style>
</head>
<body>

<div class="card">
    <div class="status" id="stat">Ø§ØªØµØ§Ù„ Ø¢Ù…Ù† ÙˆÙ…ÙˆØ­Ø¯</div>
    <div class="number">000000</div>
    <button class="btn" id="mainBtn" onclick="startSystem()">Ø¯Ø®ÙˆÙ„ Ø§Ù„ØºØ±ÙØ© Ø§Ù„ØµÙˆØªÙŠØ©</button>
    <div id="debug" style="font-size: 10px; color: #444; margin-top: 15px;">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±...</div>
    <audio id="remoteAudio" autoplay playsinline></audio>
</div>

<script>
    const ROOM_ID = "ROOM_ZERO_000000";
    let peer;

    function startSystem() {
        const btn = document.getElementById('mainBtn');
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±Ø¨Ø·...";
        
        // ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹Ø±Ù Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØµØ§Ø¯Ù…
        const myId = "User_" + Math.floor(Math.random() * 9999);
        peer = new Peer(myId);

        peer.on('open', (id) => {
            document.getElementById('stat').innerText = "âœ… Ø£Ù†Øª Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†";
            setupMic();
        });

        // Ø£Ù‡Ù… Ø¬Ø²Ø¡: Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© ÙˆØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
        peer.on('call', (call) => {
            navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
                call.answer(stream);
                call.on('stream', (remoteStream) => {
                    playRemoteStream(remoteStream);
                });
            });
        });
    }

    function setupMic() {
        navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± (Ø¨Ø§ÙØªØ±Ø§Ø¶ Ø£Ù†Ù‡ Ø¯Ø®Ù„ Ù‚Ø¨Ù„Ùƒ)
            const call = peer.call(ROOM_ID, stream);
            
            // Ø¬Ø¹Ù„ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ¹Ù…Ù„ ÙƒÙ…Ø³ØªÙ‚Ø¨Ù„ Ø¨Ø±Ù‚Ù… 000000 Ø£ÙŠØ¶Ø§Ù‹
            const master = new Peer(ROOM_ID);
            master.on('call', (incoming) => {
                incoming.answer(stream);
                incoming.on('stream', (rms) => {
                    playRemoteStream(rms);
                });
            });

            document.getElementById('mainBtn').classList.add('active');
            document.getElementById('mainBtn').innerText = "Ø£Ù†Øª ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ğŸ™ï¸";
        });
    }

    // ÙˆØ¸ÙŠÙØ© Ø®Ø§ØµØ© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª ÙÙŠ Ø§Ù„Ø¢ÙŠÙÙˆÙ† Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø§Ù„Ø­Ø¸Ø±
    function playRemoteStream(stream) {
        const audio = document.getElementById('remoteAudio');
        audio.srcObject = stream;
        audio.play().catch(e => {
            // Ø¥Ø°Ø§ Ø­Ø¸Ø± Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„ØµÙˆØªØŒ Ù†Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø©
            document.getElementById('stat').innerText = "Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø³Ù…Ø§Ø¹ Ø§Ù„ØµÙˆØª ğŸ”Š";
            document.body.onclick = () => audio.play();
        });
        document.getElementById('stat').innerText = "ğŸ”µ Ù…ØªØµÙ„: Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± ÙŠØªØ­Ø¯Ø«";
    }
</script>

</body>
</html>
