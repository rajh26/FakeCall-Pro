<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FakeCall Pro - Private ID</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/peerjs/1.4.7/peerjs.min.js"></script>
    <style>
        body { background: #000; color: white; font-family: -apple-system, sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .card { background: #1c1c1e; padding: 25px; border-radius: 20px; width: 320px; text-align: center; border: 1px solid #333; }
        h2 { color: #0a84ff; margin-bottom: 20px; }
        input { background: #2c2c2e; border: 1px solid #444; border-radius: 10px; color: white; padding: 12px; width: 90%; margin-bottom: 10px; text-align: center; font-size: 16px; }
        .btn-blue { background: #0a84ff; color: white; border: none; border-radius: 10px; padding: 12px; width: 100%; font-weight: bold; cursor: pointer; margin-bottom: 20px; }
        .btn-green { background: #30d158; color: white; border: none; border-radius: 10px; padding: 15px; width: 100%; font-weight: bold; cursor: pointer; font-size: 18px; }
        .id-display { background: #2c2c2e; padding: 10px; border-radius: 8px; margin: 10px 0; color: #30d158; font-family: monospace; border: 1px dashed #30d158; display: none; }
        #status { font-size: 12px; color: #8e8e93; margin-top: 15px; }
    </style>
</head>
<body>

<div class="card">
    <h2>Ù†Ø¸Ø§Ù… Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø®Ø§Øµ</h2>
    
    <input type="text" id="my-custom-id" placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù…Ùƒ (Ù…Ø«Ù„Ø§Ù‹: rajh26)">
    <button class="btn-blue" onclick="initMyID()">ØªÙØ¹ÙŠÙ„ Ø§Ø³Ù…ÙŠ Ø§Ù„Ø¢Ù†</button>
    
    <div class="id-display" id="display-area">Ù…Ø¹Ø±ÙÙƒ Ø§Ù„Ù†Ø´Ø·: <span id="active-id"></span></div>

    <hr style="border: 0.5px solid #333; margin: 20px 0;">

    <input type="text" id="friend-id" placeholder="Ø§Ø³Ù… Ø§Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‡">
    <button class="btn-green" onclick="startVoiceCall()">ğŸ“ Ø¨Ø¯Ø¡ Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ©</button>
    
    <div id="status">Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹</div>
    
    <audio id="remote-audio" autoplay></audio>
</div>

<script>
    let peer = null;

    // 1. ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
    function initMyID() {
        const customId = document.getElementById('my-custom-id').value;
        if (!customId) return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹ ÙŠØ§ Ø¨Ø·Ù„!");

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø®ØªØ§Ø±
        peer = new Peer(customId);

        peer.on('open', (id) => {
            document.getElementById('display-area').style.display = 'block';
            document.getElementById('active-id').innerText = id;
            document.getElementById('status').innerText = "âœ… Ù†Ø¸Ø§Ù…Ùƒ Ø¬Ø§Ù‡Ø² Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª";
            // Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ÙÙˆØ±Ø§Ù‹ Ù„ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¬Ù‡Ø§Ø²
            navigator.mediaDevices.getUserMedia({ audio: true }).then(() => {
                console.log("Mic Ready");
            });
        });

        // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
        peer.on('call', (call) => {
            if (confirm("Ù„Ø¯ÙŠÙƒ Ù…ÙƒØ§Ù„Ù…Ø© Ù…Ù† " + call.peer + " .. Ù‡Ù„ ØªØ±Ø¯ØŸ")) {
                navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
                    call.answer(stream);
                    call.on('stream', (remoteStream) => {
                        document.getElementById('remote-audio').srcObject = remoteStream;
                        document.getElementById('status').innerText = "ğŸ”µ Ù…ÙƒØ§Ù„Ù…Ø© Ø¬Ø§Ø±ÙŠØ© Ø§Ù„Ø¢Ù†...";
                    });
                });
            }
        });

        peer.on('error', (err) => {
            if (err.type === 'unavailable-id') alert("Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù…Ø­Ø¬ÙˆØ²ØŒ Ø§Ø®ØªØ± Ø§Ø³Ù…Ø§Ù‹ Ø¢Ø®Ø±");
            else alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±ØŒ Ø¬Ø±Ø¨ Ø§Ø³Ù…Ø§Ù‹ Ù…Ø®ØªÙ„ÙØ§Ù‹");
        });
    }

    // 2. Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„ØµØ¯ÙŠÙ‚
    function startVoiceCall() {
        const targetId = document.getElementById('friend-id').value;
        if (!peer) return alert("ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ Ø§Ø³Ù…Ùƒ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø£ÙˆÙ„Ø§Ù‹!");
        if (!targetId) return alert("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… ØµØ¯ÙŠÙ‚Ùƒ Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‡");

        document.getElementById('status').innerText = "ğŸš€ Ø¬Ø§Ø±ÙŠ Ø±Ù†ÙŠÙ† Ù‡Ø§ØªÙ " + targetId;

        navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
            const call = peer.call(targetId, stream);
            call.on('stream', (remoteStream) => {
                document.getElementById('remote-audio').srcObject = remoteStream;
                document.getElementById('status').innerText = "ğŸ”µ Ù…ØªØµÙ„ Ø¨Ù€ " + targetId;
            });
        }).catch(err => {
            alert("ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Safari");
        });
    }
</script>

</body>
</html>
