<script>
    // ุฅูุดุงุก ูุนุฑู ูุฏูู ุนุดูุงุฆู ูุถูุงู ุนุฏู ุงูุงุนุชูุงุฏ ุงูููู ุนูู ุงูุณูุฑูุฑ ูู ุงูุชูููุฏ
    const manualId = "ID-" + Math.floor(Math.random() * 90000 + 10000);
    const peer = new Peer(manualId); 

    // ุฃูู ูุง ููุชุญ ุงูุณูุฑูุฑ
    peer.on('open', (id) => {
        document.getElementById('my-id').innerText = id;
        document.getElementById('status').innerText = "โ ุชู ุงุณุชุฎุฑุงุฌ ุฑููู ุจูุฌุงุญ";
    });

    // ูุนุงูุฌุฉ ุงูุฎุทุฃ ุฅุฐุง ูู ูุธูุฑ ุงูุฑูู
    peer.on('error', (err) => {
        console.log(err);
        document.getElementById('my-id').innerText = manualId; // ุฅุธูุงุฑ ุงูุฑูู ุงููุฏูู ูุฎุทุฉ ุจุฏููุฉ
        document.getElementById('status').innerText = "โ๏ธ ูุถุน ุงูุงุชุตุงู ุงููุฏูู ููุนูู";
    });

    // ุจููุฉ ูุธุงุฆู ุงูุงุชุตุงู...
    function makeCall() {
        const destId = document.getElementById('friend-id').value;
        if (!destId) return alert("ูู ูุถูู ุฃุฏุฎู ุฑูู ุตุฏููู ุฃููุงู");

        // ุทูุจ ุงูุฅุฐู ุงูุตุฑูุญ ูุจู ุงูุงุชุตุงู
        navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
            const call = peer.call(destId, stream);
            document.getElementById('status').innerText = "๐ ุฌุงุฑู ุงูุงุชุตุงู...";
            call.on('stream', (remoteStream) => {
                document.getElementById('remote-audio').srcObject = remoteStream;
                document.getElementById('status').innerText = "๐ต ูุชุตู ุงูุขู!";
            });
        }).catch(err => {
            alert("ูุง ูููู ุงูุงุชุตุงู ุจุฏูู ูููุฑูููู. ุงุฐูุจ ููุฅุนุฏุงุฏุงุช ููุนูู ููุชุตูุญ Safari");
        });
    }
</script>
